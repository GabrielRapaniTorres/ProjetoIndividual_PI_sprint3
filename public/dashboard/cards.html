<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz Musical | VibeTrack</title>
    <link rel="stylesheet" href="../style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #e0e0e0;
            overflow-x: hidden;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background-color: #1f2937;
            display: flex;
            align-items: center;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
        }

        .header .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }

        .titulo {
            margin: 0;
            color: #60a5fa;
            font-weight: 700;
            font-size: 29px;
            /* antes 1.8em */
        }

        .navbar {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
        }

        .navbar li a {
            color: #e0e0e0;
            text-decoration: none;
            font-weight: 600;
            text-transform: capitalize;
            transition: color 0.3s ease;
        }

        .navbar li.agora a {
            color: #60a5fa;
        }

        .navbar li a:hover {
            color: #2563eb;
        }

        .secao-jogo {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            min-height: calc(100vh - 70px);
        }

        #jogo-container {
            background-color: #1f2937;
            padding: 30px 35px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.7);
            margin-top: 20px;
            max-width: 600px;
            width: 100%;
        }

        #pergunta-container p {
            font-size: 26px;
            /* antes 1.6em */
            color: #d1d5db;
            margin-bottom: 30px;
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        #respostas-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 18px;
            margin-bottom: 25px;
        }

        .resposta-btn {
            background-color: #4c51bf;
            color: #f9fafb;
            border: none;
            padding: 16px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            /* antes 1.15em */
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 3px 8px rgba(76, 81, 191, 0.4);
        }

        .resposta-btn:hover:not(:disabled) {
            background-color: #434aa8;
            transform: scale(1.04);
        }

        .resposta-btn.correta {
            background-color: #22c55e;
            box-shadow: 0 0 12px #22c55e;
        }

        .resposta-btn.incorreta {
            background-color: #ef4444;
            box-shadow: 0 0 12px #ef4444;
        }

        #feedback-container {
            margin-top: 25px;
            font-size: 21px;
            /* antes 1.3em */
            color: #cbd5e1;
            font-weight: 700;
            min-height: 40px;
            user-select: none;
        }

        #proxima-pergunta-btn {
            background-color: #2563eb;
            color: #e0e7ff;
            border: none;
            padding: 14px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 19px;
            /* antes 1.2em */
            margin-top: 20px;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.6);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        #proxima-pergunta-btn:hover {
            background-color: #1e40af;
            transform: scale(1.05);
        }

        #resultado-final {
            background-color: #1f2937;
            padding: 30px 35px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.75);
            max-width: 600px;
            margin-top: 40px;
            color: #d1d5db;
            display: none;
        }

        #resultado-final h2 {
            color: #60a5fa;
            font-size: 40px;
            /* antes 2.5em */
            margin-bottom: 15px;
            letter-spacing: 0.04em;
        }

        #resultado-final p {
            font-size: 22px;
            /* antes 1.4em */
            color: #cbd5e1;
            font-weight: 700;
            margin-bottom: 25px;
        }

        #resultado-final button {
            background-color: #2563eb;
            color: #e0e7ff;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 19px;
            /* antes 1.2em */
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.7);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        #resultado-final button:hover {
            background-color: #1e40af;
            transform: scale(1.05);
        }

        #iniciar-jogo-btn {
            background-color: #2563eb;
            color: #e0e7ff;
            border: none;
            padding: 20px 45px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 21px;
            /* antes 1.3em */
            font-weight: 700;
            margin-top: 50px;
            box-shadow: 0 5px 20px rgba(37, 99, 235, 0.7);
            transition: background-color 0.3s ease, transform 0.25s ease;
        }

        #iniciar-jogo-btn:hover {
            background-color: #1e40af;
            transform: scale(1.07);
        }

        .oculto {
            display: none;
        }
    </style>
</head>

<body>

    <div class="header">
        <div class="container">
            <h1 class="titulo">VibeTrack</h1>
            <ul class="navbar">
                <li>
                    <a href="../index.html">inicio</a>
                </li>
                <li>
                    <a href="../simulador.html">Sobre</a>
                </li>
                <li>
                    <a href="../login.html">Login</a>
                </li>
                <li>
                    <a href="../cadastro.html">Cadastro</a>
                </li>
            </ul>
        </div>
    </div>

    <section class="secao-jogo">
        <button id="iniciar-jogo-btn">Iniciar Quiz Musical!</button>

        <div id="jogo-container" class="oculto">
            <div id="pergunta-container">
                <p id="pergunta"></p>
            </div>
            <div id="respostas-container">
                <button class="resposta-btn" data-index="0"></button>
                <button class="resposta-btn" data-index="1"></button>
                <button class="resposta-btn" data-index="2"></button>
                <button class="resposta-btn" data-index="3"></button>
            </div>
            <div id="feedback-container" class="oculto">
                <p id="feedback-mensagem"></p>
                <button id="proxima-pergunta-btn">Próxima Pergunta</button>
            </div>
        </div>

        <div id="resultado-final">
            <h2>Parabéns!</h2>
            <p id="mensagem-resultado"></p>
            <button onclick="location.reload()">Reiniciar Quiz</button>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const iniciarJogoBtn = document.getElementById('iniciar-jogo-btn');
            const jogoContainer = document.getElementById('jogo-container');
            const perguntaContainer = document.getElementById('pergunta');
            const respostasContainer = document.getElementById('respostas-container');
            const feedbackContainer = document.getElementById('feedback-container');
            const feedbackMensagem = document.getElementById('feedback-mensagem');
            const proximaPerguntaBtn = document.getElementById('proxima-pergunta-btn');
            const resultadoFinal = document.getElementById('resultado-final');
            const mensagemResultado = document.getElementById('mensagem-resultado');
            const respostaBotoes = document.querySelectorAll('.resposta-btn');

            const perguntas = [
                {
                    pergunta: "Qual instrumento é conhecido como 'o rei dos instrumentos'?",
                    respostas: ["Violino", "Guitarra", "Piano", "Bateria"],
                    respostaCorreta: 2
                },
                {
                    pergunta: "Quem é conhecido como o 'Rei do Pop'?",
                    respostas: ["Prince", "Madonna", "Elvis Presley", "Michael Jackson"],
                    respostaCorreta: 3
                },
                {
                    pergunta: "Qual destes gêneros musicais se originou em Nova Orleans, EUA?",
                    respostas: ["Blues", "Jazz", "Country", "Rock and Roll"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Qual compositor clássico é famoso por suas 'Nove Sinfonias'?",
                    respostas: ["Mozart", "Beethoven", "Bach", "Chopin"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Qual artista brasileira popularizou o 'axé music' nos anos 90?",
                    respostas: ["Marisa Monte", "Gal Costa", "Ivete Sangalo", "Daniela Mercury"],
                    respostaCorreta: 3
                },
                {
                    pergunta: "Qual destes álbuns é considerado um marco do rock progressivo?",
                    respostas: ["Dark Side of the Moon", "Abbey Road", "Back in Black", "Hotel California"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Quem compôs a famosa ópera 'Carmen'?",
                    respostas: ["Verdi", "Puccini", "Bizet", "Wagner"],
                    respostaCorreta: 2
                },
                {
                    pergunta: "Qual destes instrumentos é de cordas?",
                    respostas: ["Flauta", "Trompete", "Violão", "Bateria"],
                    respostaCorreta: 2
                },
                {
                    pergunta: "Quem é conhecido como o 'Pai do Blues'?",
                    respostas: ["Robert Johnson", "B.B. King", "Muddy Waters", "Howlin' Wolf"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Qual destes festivais é famoso por sua conexão com a música psicodélica?",
                    respostas: ["Lollapalooza", "Woodstock", "Coachella", "Glastonbury"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Qual destes artistas é conhecido por seu estilo de vida extravagante e performances teatrais?",
                    respostas: ["David Bowie", "Freddie Mercury", "Elton John", "Prince"],
                    respostaCorreta: 2
                },
                {
                    pergunta: "Qual destes gêneros musicais é caracterizado por seu ritmo rápido e letras de protesto?",
                    respostas: ["Reggae", "Punk Rock", "Samba", "Funk"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Quem é o cantor principal da banda britânica Coldplay?",
                    respostas: ["Chris Martin", "Bono Vox", "Thom Yorke", "James Blunt"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Qual destes instrumentos é tocado com um arco?",
                    respostas: ["Guitarra", "Violino", "Piano", "Saxofone"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Quem é conhecido como a 'Rainha do Pop'?",
                    respostas: ["Beyoncé", "Madonna", "Lady Gaga", "Adele"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Qual destes álbuns é considerado um clássico do grunge?",
                    respostas: ["Nevermind", "OK Computer", "The Wall", "Rumours"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Quem compôs a famosa canção 'Bohemian Rhapsody'?",
                    respostas: ["John Lennon", "Freddie Mercury", "Mick Jagger", "Robert Plant"],
                    respostaCorreta: 1
                },
                {
                    pergunta: "Qual destes gêneros musicais é originário do Brasil?",
                    respostas: ["Samba", "Reggae", "Hip Hop", "Country"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Quem é o famoso guitarrista da banda Guns N' Roses?",
                    respostas: ["Slash", "Kirk Hammett", "Jimmy Page", "Eric Clapton"],
                    respostaCorreta: 0
                },
                {
                    pergunta: "Qual destes instrumentos é conhecido por seu som suave e melódico?",
                    respostas: ["Trombone", "Saxofone", "Guitarra Elétrica", "Bateria"],
                    respostaCorreta: 1
                }

            ];

            let perguntaAtualIndex = 0;
            let pontuacao = 0;

            iniciarJogoBtn.addEventListener('click', function () {
                iniciarJogoBtn.classList.add('oculto');
                jogoContainer.classList.remove('oculto');
                exibirPergunta();
            });

            function exibirPergunta() {
                esconderFeedback();
                limparBotoes();

                const perguntaAtual = perguntas[perguntaAtualIndex];
                perguntaContainer.textContent = perguntaAtual.pergunta;

                for (let i = 0; i < respostaBotoes.length; i++) {
                    respostaBotoes[i].textContent = perguntaAtual.respostas[i];
                    respostaBotoes[i].dataset.index = i;
                    respostaBotoes[i].disabled = false;
                    respostaBotoes[i].classList.remove('correta', 'incorreta');

                    respostaBotoes[i].onclick = function () {
                        verificarResposta(i);
                    };
                }
            }

            function verificarResposta(respostaSelecionadaIndex) {
                const perguntaAtual = perguntas[perguntaAtualIndex];
                const respostaCorretaIndex = perguntaAtual.respostaCorreta;
                const idUsuario = sessionStorage.ID_USUARIO; // Certifique-se de que esse valor está no sessionStorage
                const idPergunta = perguntaAtualIndex + 1; // Supondo que o índice representa a pergunta no banco

                const acertou = respostaSelecionadaIndex === respostaCorretaIndex;

                if (acertou) {
                    respostaBotoes[respostaSelecionadaIndex].classList.add('correta');
                    feedbackMensagem.textContent = "Você acertou! Mandou bem!";
                    pontuacao = pontuacao + 1;
                } else {
                    respostaBotoes[respostaSelecionadaIndex].classList.add('incorreta');
                    respostaBotoes[respostaCorretaIndex].classList.add('correta');
                    feedbackMensagem.textContent = "Que pena! A resposta correta era: \"" + perguntaAtual.respostas[respostaCorretaIndex] + "\".";
                }

                for (let i = 0; i < respostaBotoes.length; i++) {
                    respostaBotoes[i].disabled = true;
                }

                feedbackContainer.classList.remove('oculto');
                proximaPerguntaBtn.classList.remove('oculto');

                // Enviar resposta para o banco de dados
                fetch('/quiz/responder', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        id_usuario: idUsuario,
                        id_pergunta: idPergunta,
                        resposta_escolhida: respostaSelecionadaIndex,
                        correta: acertou
                    })
                })
                    .then(response => {
                        if (!response.ok) {
                            console.error('Erro ao salvar resposta no banco.');
                        }
                    })
                    .catch(error => {
                        console.error('Erro na requisição:', error);
                    });
            }

            proximaPerguntaBtn.addEventListener('click', (event) => {
                perguntaAtualIndex = perguntaAtualIndex + 1;

                if (perguntaAtualIndex < perguntas.length) {
                    exibirPergunta();
                } else {
                    mostrarResultadoFinal();
                }
            });

            function esconderFeedback() {
                feedbackContainer.classList.add('oculto');
                proximaPerguntaBtn.classList.add('oculto');
            }

            function limparBotoes() {
                for (let i = 0; i < respostaBotoes.length; i++) {
                    respostaBotoes[i].classList.remove('correta');
                    respostaBotoes[i].classList.remove('incorreta');
                    respostaBotoes[i].disabled = false;
                }
            }

            function mostrarResultadoFinal() {
                jogoContainer.classList.add('oculto');
                resultadoFinal.style.display = 'block';
                mensagemResultado.textContent = "Você acertou " + pontuacao + " de " + perguntas.length + " perguntas!";
            }
        });
    </script>
</body>

</html>